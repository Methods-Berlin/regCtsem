<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Regularized Continuous Time Structural Equation Modeling.
regCtsem uses objects from ctsemOMX and implements lasso, adaptive lasso and ridge regularization."><title>regCtsem — regCtsem • regCtsem</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="regCtsem — regCtsem"><meta property="og:description" content="Regularized Continuous Time Structural Equation Modeling.
regCtsem uses objects from ctsemOMX and implements lasso, adaptive lasso and ridge regularization."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">regCtsem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/regCtsem.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/MatrixExponential.html">MatrixExponential</a>
    <a class="dropdown-item" href="../articles/cpptsem.html">cpptsem</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>regCtsem</h1>
      
      <div class="d-none name"><code>regCtsem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Regularized Continuous Time Structural Equation Modeling.</p>
<p>regCtsem uses objects from ctsemOMX and implements lasso, adaptive lasso and ridge regularization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">regCtsem</span><span class="op">(</span></span>
<span>  <span class="va">ctsemObject</span>,</span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">regIndicators</span>,</span>
<span>  targetVector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambdas <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  lambdasAutoLength <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  lambdasAutoCurve <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  penalty <span class="op">=</span> <span class="st">"lasso"</span>,</span>
<span>  adaptiveLassoWeights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adaptiveLassoPower <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  cvSample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  autoCV <span class="op">=</span> <span class="st">"No"</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  sparseParameters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subjectSpecificParameters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  standardizeDrift <span class="op">=</span> <span class="st">"No"</span>,</span>
<span>  scaleLambdaWithN <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnFitIndices <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  BICWithNAndT <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optimization <span class="op">=</span> <span class="st">"exact"</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"GIST"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  trainingWheels <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ctsemObject</dt>
<dd><p>Fitted object of class ctsemFit</p></dd>


<dt>dataset</dt>
<dd><p>Data set in wide format compatible with ctsemOMX</p></dd>


<dt>regIndicators</dt>
<dd><p>Labels of the regularized parameters (e.g. drift_eta1_eta2).</p></dd>


<dt>targetVector</dt>
<dd><p>named vector with values towards which the parameters are regularized (Standard is regularization towards zero)</p></dd>


<dt>lambdas</dt>
<dd><p>vector of penalty values (tuning parameter). E.g., seq(0,1,.01). Alternatively, lambdas can be set to "auto". regCtsem will then compute an upper limit for lambda and test lambdasAutoLength increasing lambda values</p></dd>


<dt>lambdasAutoLength</dt>
<dd><p>if lambdas == "auto", lambdasAutoLength will determine the number of lambdas tested.</p></dd>


<dt>lambdasAutoCurve</dt>
<dd><p>It is often a good idea to have unequally spaced lambda steps (e.g., .01,.02,.05,1,5,20). If lambdasAutoCurve is close to 1 lambda values will be equally spaced, if lambdasAutoCurve is large lambda values will be more concentrated close to 0. See ?getCurvedLambda for more informations.</p></dd>


<dt>penalty</dt>
<dd><p>Currently supported are lasso, ridge and adaptiveLasso</p></dd>


<dt>adaptiveLassoWeights</dt>
<dd><p>weights for the adaptive lasso. Defaults to 1/(|theta|^adaptiveLassoPower), where theta is the maximum likelihood estimate of the regularized parameters.</p></dd>


<dt>adaptiveLassoPower</dt>
<dd><p>power for the adaptive lasso weights. The weights will be set to 1/(|theta|^adaptiveLassoPower).</p></dd>


<dt>cvSample</dt>
<dd><p>cross-validation sample. Has to be in wide format and compatible with ctsemOMX</p></dd>


<dt>autoCV</dt>
<dd><p>Should automatic cross-validation be used? Possible are "No", "kFold" or "Blocked". kFold splits the dataset in k groups by selecting independent units from the rows. Blocked is a within-unit split, where for each person blocks of observations are deleted. See Bulteel, K., Mestdagh, M., Tuerlinckx, F., &amp; Ceulemans, E. (2018). VAR(1) based models do not always outpredict AR(1) models in typical psychological applications. Psychological Methods, 23(4), 740-756. https://doi.org/10.1037/met0000178 for a more detailed explanation</p></dd>


<dt>k</dt>
<dd><p>number of cross-validation folds if autoCV = "kFold" or autoCV = "Blocked"</p></dd>


<dt>sparseParameters</dt>
<dd><p>labeled vector with parameter estimates of the most sparse model. If regValues = "auto" the sparse parameters will be computed automatically.</p></dd>


<dt>subjectSpecificParameters</dt>
<dd><p>EXPERIMENTAL! A vector of parameter labels for parameters which should be estimated person-specific. If these parameter labels are also passed to regIndicators, all person-specific parameters will be regularized towards a group-parameter. This is a 2-step-procedure: In step 1 all parameters are constrained to equality between individuals to estimate the group parameters. In step 2 the parameters are estimated person-specific, but regularized towards the group parameter from step 1.</p></dd>


<dt>standardizeDrift</dt>
<dd><p>Should Drift parameters be standardized automatically? Set to 'No' for no standardization, 'T0VAR' for standardization using the T0VAR or 'asymptoticDiffusion' for standardization using the asymptotic diffusion</p></dd>


<dt>scaleLambdaWithN</dt>
<dd><p>Boolean: Should the penalty value be scaled with the sample size? True is recommended as the likelihood is also sample size dependent</p></dd>


<dt>returnFitIndices</dt>
<dd><p>Boolean: should fit indices be returned?</p></dd>


<dt>BICWithNAndT</dt>
<dd><p>Boolean: TRUE = Use N and T in the formula for the BIC (-2log L + log(N+T)*k, where k is the number of parameters in the model). FALSE = Use N in the formula for the BIC (-2log L + log(N)). Defaults to FALSE</p></dd>


<dt>optimization</dt>
<dd><p>which optimization procedure should be used. Possible are  "exact" or "approx". exact is recommended for sparsity inducing penalty functions (lasso and adaptive lasso)</p></dd>


<dt>optimizer</dt>
<dd><p>for exact optimization: Either GIST or GLMNET. When using optimization = "approx", Rsolnp or any of the optimizers in optimx can be used. See ?optimx</p></dd>


<dt>control</dt>
<dd><p>List with control arguments for the optimizer. See ?controlGIST, ?controlGLMNET and ?controlApprox for the respective parameters</p></dd>


<dt>verbose</dt>
<dd><p>0 (default), 1 for convergence plot, 2 for parameter convergence plot and line search progress.</p></dd>


<dt>trainingWheels</dt>
<dd><p>If set to FALSE all bells and whistles used to keep regCtsem on track are turned off (no multiple starting values, no initial optimization with solnp or optimx). The focus is speed instead of accuracy. This might work in simulated data, but is NOT recommended with real data. The optimizer is quite likely to get stuck in local minima.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>returns an object of class regCtsem. Without cross-validation, this object will have the fields setup (all arguments passed to the function), fitAndParameters (used internally to store the fit and the raw (i.e., untransformed) parameters), fit (fit indices, ect.), parameterEstimatesRaw (raw, i.e. untransformed parameters; used internally), and parameters (transformed parameters)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>REGularized Continuous Time Structural Equation Models (regCtsem) implements least absolute shrinkage and selection operator (LASSO; Tibshirani, 1996) and adaptive LASSO (Zou, 2006) regularization for models fitted with ctsemOMX (Driver et al., 2017). See vignette("regCtsem", package = "regCtsem") for an introduction and additional examples.</p>
<p>References:</p>
<p>* Driver, C. C., Oud, J. H. L., &amp; Voelkle, M. C. (2017). Continuous Time Structural Equation Modelling With R Package ctsem. Journal of Statistical Software, 77(5), 1-36. https://doi.org/10.18637/jss.v077.i05</p>
<p>* Tibshirani, R. (1996). Regression Shrinkage and Selection via the Lasso. Journal of the Royal Statistical Society. Series B (Methodological), 58(1), 267-288.</p>
<p>* Zou, H. (2006). The Adaptive Lasso and Its Oracle Properties. Journal of the American Statistical Association, 101(476), 1418-1429. https://doi.org/10.1198/016214506000000735</p>
<p>NOTE: Function located in file regCtsem.R</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jannik Orzek</p>
<p>Jannik Orzek &lt;orzek@mpib-berlin.mpg.de&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># \donttest{</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">17046</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/regCtsem/">regCtsem</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### Example 1 ####</span></span>
<span><span class="co">## Regularization with FIML objective function</span></span>
<span></span>
<span><span class="co">## Population model:</span></span>
<span></span>
<span><span class="co"># set the drift matrix. Note that drift eta_1_eta2 is set to equal 0 in the population.</span></span>
<span><span class="va">ct_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>,<span class="fl">.2</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">generatingModel</span><span class="op">&lt;-</span><span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">10</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,</span>
<span>                                n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                DRIFT<span class="op">=</span><span class="va">ct_drift</span>,</span>
<span>                                DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0VAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate a training data set</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctGenerate.html" class="external-link">ctGenerate</a></span><span class="op">(</span><span class="va">generatingModel</span>, n.subjects <span class="op">=</span> <span class="fl">100</span>, wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build the analysis model. Note that drift eta1_eta2 is freely estimated</span></span>
<span><span class="co"># although it is 0 in the population.</span></span>
<span><span class="va">myModel</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">10</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,</span>
<span>                          n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                          LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'eta1_eta1'</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">'eta2_eta2'</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0VAR<span class="op">=</span><span class="st">"auto"</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit the model using ctsemOMX:</span></span>
<span><span class="va">fit_myModel</span> <span class="op">&lt;-</span> <span class="fu">ctsemOMX</span><span class="fu">::</span><span class="fu">ctFit</span><span class="op">(</span><span class="va">dat</span>, <span class="va">myModel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select DRIFT values for regularization:</span></span>
<span><span class="co"># Note: If you are unsure what the parameters are called in</span></span>
<span><span class="co"># your model, check: showParameters(fit_myModel)</span></span>
<span><span class="fu"><a href="showParameters.html">showParameters</a></span><span class="op">(</span><span class="va">fit_myModel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># regularize the cross-effects:</span></span>
<span><span class="va">regIndicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optimize model using GIST with lasso penalty</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                               dataset <span class="op">=</span> <span class="va">dat</span>,</span>
<span>                               regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                               lambdas <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>                               lambdasAutoLength <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regModel</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span>, what <span class="op">=</span> <span class="st">"fit"</span>, criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"m2LL"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The best parameter estimates and the final model as mxObject can be extracted with:</span></span>
<span><span class="co"># getFinalParameters(regCtsemObject = regModel, criterion = "BIC")</span></span>
<span><span class="co"># bestModel &lt;- getFinalModel(regCtsemObject = regModel, criterion = "BIC")</span></span>
<span><span class="co"># WARNING: The returned model is of type cpptsem. You can access it's elements with the</span></span>
<span><span class="co"># $ operator. For example: bestModel$DRIFTValues</span></span>
<span></span>
<span><span class="co"># WARNING: If you load an existing regCtsem object, the underlying C++ model will no longer</span></span>
<span><span class="co"># exist. You can restore this model with restore(). Example:</span></span>
<span><span class="co"># save(regModel, file = "regModel.RData")</span></span>
<span><span class="co"># load("regModel.RData")</span></span>
<span><span class="co"># regModel &lt;- restore(regModel)</span></span>
<span><span class="co"># regModel$setup$cpptsemObject$DRIFTValues</span></span>
<span></span>
<span><span class="co"># Optimize model using GLMNET with lasso penalty</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                               dataset <span class="op">=</span> <span class="va">dat</span>,</span>
<span>                               regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                               lambdas <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>                               lambdasAutoLength <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                               optimizer <span class="op">=</span> <span class="st">"GLMNET"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regModel</span>, criterion <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span>, what <span class="op">=</span> <span class="st">"drift"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span>, what <span class="op">=</span> <span class="st">"fit"</span>, criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"m2LL"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span>, what <span class="op">=</span> <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The same regularization can be performed with the approximate optimization:</span></span>
<span><span class="va">regModelApprox</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                                     dataset <span class="op">=</span> <span class="va">dat</span>,</span>
<span>                                     regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                                     lambdas <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>                                     lambdasAutoLength <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                     optimization <span class="op">=</span> <span class="st">"approx"</span>,</span>
<span>                                     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                                       epsilon <span class="op">=</span> <span class="fl">.001</span>, <span class="co"># epsilon is used to transform the non-differentiable</span></span>
<span>                                       <span class="co">#lasso penalty to a differentiable one if optimization = approx</span></span>
<span>                                       zeroThresh <span class="op">=</span> <span class="fl">.04</span> <span class="co"># threshold below which parameters will be evaluated as == 0</span></span>
<span>                                     <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Comparison of parameter estimates:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">regModel</span><span class="op">$</span><span class="va">fitAndParameters</span> <span class="op">-</span> <span class="va">regModelApprox</span><span class="op">$</span><span class="va">fitAndParameters</span>,<span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### Example 2 ####</span></span>
<span><span class="co">## Regularization with Kalman objective function</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">175446</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## define the population model:</span></span>
<span></span>
<span><span class="co"># set the drift matrix. Note that drift eta_1_eta2 is set to equal 0 in the population.</span></span>
<span><span class="va">ct_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>,<span class="fl">.2</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">generatingModel</span><span class="op">&lt;-</span><span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">100</span>,n.latent<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                n.TDpred<span class="op">=</span><span class="fl">0</span>,n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                DRIFT<span class="op">=</span><span class="va">ct_drift</span>,</span>
<span>                                DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0VAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate a training data and testing data set</span></span>
<span><span class="va">traindata</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctGenerate.html" class="external-link">ctGenerate</a></span><span class="op">(</span><span class="va">generatingModel</span>,n.subjects <span class="op">=</span> <span class="fl">10</span>, wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctGenerate.html" class="external-link">ctGenerate</a></span><span class="op">(</span><span class="va">generatingModel</span>,n.subjects <span class="op">=</span> <span class="fl">10</span>, wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build the analysis model. Note that drift eta1_eta2 is freely estimated</span></span>
<span><span class="co"># although it is 0 in the population.</span></span>
<span><span class="va">myModel</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">100</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,</span>
<span>                          n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                          LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'eta1_eta1'</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">'eta2_eta2'</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0VAR<span class="op">=</span><span class="st">"auto"</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span><span class="va">fit_myModel</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">traindata</span>, ctmodelobj <span class="op">=</span> <span class="va">myModel</span>, objective <span class="op">=</span> <span class="st">"Kalman"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select DRIFT values:</span></span>
<span><span class="va">regIndicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span><span class="co"># Note: If you are unsure what the parameters are called in</span></span>
<span><span class="co"># your model, check: fit_myModel$ctmodelobj$DRIFT for the drift or</span></span>
<span><span class="co"># omxGetParameters(fit_myModel$ctmodelobj) for all parameters</span></span>
<span></span>
<span><span class="co">## Optimization with GIST:</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                               dataset <span class="op">=</span> <span class="va">traindata</span>,</span>
<span>                               regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                               lambdas <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>                               lambdasAutoLength <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                               cvSample <span class="op">=</span> <span class="va">testdata</span> <span class="co"># data set for cross-validation</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regModel</span>, criterion <span class="op">=</span> <span class="st">"cvM2LL"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span>, what <span class="op">=</span> <span class="st">"fit"</span>, criterion <span class="op">=</span> <span class="st">"cvM2LL"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### EXPERIMENTAL FEATURES: USE WITH CAUTION! ####</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/regCtsem/">regCtsem</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Example 4: Kalman Filter with person specific parameter values</span></span>
<span><span class="co">## WARNING: THIS WILL TAKE A WHILE TO RUN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">175446</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## define the population model:</span></span>
<span></span>
<span><span class="co"># set the drift matrix. Note that drift eta_1_eta2 is set to equal 0 in the population.</span></span>
<span><span class="va">ct_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>,<span class="fl">0</span>,<span class="fl">.2</span>,<span class="op">-</span><span class="fl">.2</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">indpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will simulate data for 10 individuals with person-specific parameters</span></span>
<span><span class="co"># These person-specific parameters will then be regularized towards a</span></span>
<span><span class="co"># common group parameter</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">while</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">DRIFT</span> <span class="op">&lt;-</span> <span class="va">ct_drift</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">DRIFT</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw">break</span><span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">indpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">indpars</span>, <span class="va">DRIFT</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">generatingModel</span><span class="op">&lt;-</span><span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">50</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                  MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                  LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                  DRIFT<span class="op">=</span><span class="va">DRIFT</span>,</span>
<span>                                  DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                  CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                  T0VAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span>  <span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctGenerate.html" class="external-link">ctGenerate</a></span><span class="op">(</span><span class="va">generatingModel</span>,n.subjects <span class="op">=</span> <span class="fl">1</span>, wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Build the analysis model.</span></span>
<span><span class="va">myModel</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">50</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                          LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'eta1_eta1'</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">'eta2_eta2'</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0VAR<span class="op">=</span><span class="st">"auto"</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span><span class="va">myModel</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span><span class="va">myModel</span>, dat <span class="op">=</span> <span class="va">dataset</span>, objective <span class="op">=</span> <span class="st">"Kalman"</span>,</span>
<span>                 useOptimizer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">regIndicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span><span class="co"># the following parameters will be estimated person-specific and (as we specified this above)</span></span>
<span><span class="co"># regularized. The regularization will be towards a group parameter</span></span>
<span><span class="va">subjectSpecificParameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">myModel</span>,</span>
<span>                     dataset <span class="op">=</span> <span class="va">dataset</span>,</span>
<span>                     regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                     lambdasAutoLength <span class="op">=</span> <span class="fl">5</span>, <span class="co"># 5 will not be enough, but this takes some time to execute</span></span>
<span>                     subjectSpecificParameters <span class="op">=</span> <span class="va">subjectSpecificParameters</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regModel</span>, criterion <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span>, what <span class="op">=</span> <span class="st">"drift"</span><span class="op">)</span></span>
<span><span class="co"># }</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

