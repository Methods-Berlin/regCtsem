<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="regCtsem">
<title>regCtsem • regCtsem</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="regCtsem">
<meta property="og:description" content="regCtsem">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">regCtsem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/regCtsem.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/MatrixExponential.html">MatrixExponential</a>
    <a class="dropdown-item" href="../articles/cpptsem.html">cpptsem</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>regCtsem</h1>
            
      
      
      <div class="d-none name"><code>regCtsem.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="general-introduction">General Introduction<a class="anchor" aria-label="anchor" href="#general-introduction"></a>
</h2>
<p><strong>Reg</strong>ularized <strong>C</strong>ontinuous
<strong>T</strong>ime <strong>S</strong>tructural
<strong>E</strong>quation <strong>M</strong>odels (regCtsem) implements
least absolute shrinkage and selection operator (LASSO; Tibshirani,
1996) and adaptive LASSO (Zou, 2006) regularization for models of the
following form:</p>
<p><span class="math display">\[
\begin{aligned}
\text{d}\pmb{\eta}(t) &amp;= \Big(\pmb A \boldsymbol{\eta}(t) + \pmb b +
\pmb\kappa \Big) \text{d} t + \pmb G\text d \pmb W(t)\\
\end{aligned}
\]</span> <span class="math inline">\(\pmb\eta (t)\)</span> is a vector
with states of the latent variables <span class="math inline">\(\pmb
\eta\)</span> at time point <span class="math inline">\(t\)</span>.
<span class="math inline">\(\mathbf A\)</span> is the drift matrix with
auto-effects in the diagonal and cross-effects in the off-diagonal,
<span class="math inline">\(\pmb b\)</span> is a vector with continuous
time intercepts, <span class="math inline">\(\pmb \kappa\)</span> allows
for trait variance and <span class="math inline">\(\pmb G\)</span> is
the diffusion matrix which allows modulation of the stochastic part of
the model (the Wiener process <span class="math inline">\(\mathbf
W\)</span>). The latent variables in <span class="math inline">\(\pmb
\eta\)</span> are related to manifest measurements by the following
measurement equation:</p>
<p><span class="math display">\[
\pmb y(t_u) = \pmb d + \pmb C\pmb \eta(t_u) + \pmb \varepsilon_{t_u}
\]</span> Here, <span class="math inline">\(\pmb y(t_u)\)</span> is a
vector with observations at time <span class="math inline">\(t_u\)</span> of measurement occasion <span class="math inline">\(u\)</span>, <span class="math inline">\(\pmb
d\)</span> is a vector with discrete time intercepts, <span class="math inline">\(\pmb C\)</span> a matrix with loadings, and <span class="math inline">\(\pmb \varepsilon_{t_u}\)</span> a vector with
residuals. A thorough introduction to continuous time structural
equation models is provided by Voelkle et al. (2012).</p>
<p>In R, models of the form shown above can, for instance, be fitted
with the packages <strong>ctsemOMX</strong> and <strong>ctsem</strong>
(Driver et al., 2017) which <strong>regCtsem</strong> builds on.</p>
<div class="section level3">
<h3 id="regularization">Regularization<a class="anchor" aria-label="anchor" href="#regularization"></a>
</h3>
<p><strong>regCtsem</strong> extends <strong>ctsemOMX</strong> by
allowing for LASSO and adaptive LASSO regularization (see Jacobucci et
al., 2016 and Huang et al., 2017 for an introduction to regularized
SEM). The objective function is given by <span class="math display">\[f(\pmb\theta) = L(\pmb\theta) + N\sum_{j\in
J}\lambda_j|\theta_j - \tau_j|\]</span> where <span class="math inline">\(f(\pmb\theta)\)</span> is the regularized
objective function, <span class="math inline">\(L(\pmb \theta)\)</span>
is the -2 log Likelihood of the model <span class="math inline">\(N\)</span> is the sample size and <span class="math inline">\(\sum_{j\in J}\lambda_j|\theta_j - \tau_j|\)</span>
is the penalty term. Here, <span class="math inline">\(J\)</span> is a
set of parameter indices and <span class="math inline">\(\theta_{j,j\in
J}\)</span> are the parameters which are to be regularized. This will
become more clear in the following examples. In the penalty term <span class="math inline">\(\tau_j\)</span> is the target towards which the
parameter <span class="math inline">\(\theta_j\)</span> is regularized.
By default this is set to <span class="math inline">\(0\)</span>. <span class="math inline">\(\lambda_j\)</span> controls the relative
importance of the -2 log Likelihood and the penalty term. For larger
<span class="math inline">\(\lambda_j\)</span> parameter <span class="math inline">\(\theta_j\)</span> will be pulled towards <span class="math inline">\(\tau_j\)</span>. By default the same <span class="math inline">\(\lambda\)</span> is used for all regularized
parameters. This is shown in the figure below, where the <span class="math inline">\(x\)</span>-axis shows the <span class="math inline">\(\lambda\)</span> values and the blue lines are two
regularized parameters. For larger <span class="math inline">\(\lambda\)</span> these are pulled towards the
target <span class="math inline">\(0\)</span>.</p>
<p><img src="regCtsem_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Using LASSO and adaptive LASSO regularization automatically generates
models of increasing sparsity. Among these models we can select the best
generalizing one based on cross-validation or information criteria.</p>
</div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>As outlined above <strong>regCtsem</strong> builds on
<strong>ctsemOMX</strong>. Many models fitted with
<strong>ctsemOMX</strong> can directly be passed to
<strong>regCtsem</strong>. Therefore, we highly recommend that you
familiarize yourself with <strong>ctsemOMX</strong>. In the most basic
setup <strong>regCtsem</strong> expects a fitted model from
<strong>ctsemOMX</strong> and the data set in wide format as well as a
vector with names of the parameters which should be regularized. The
following example is taken from the documentation of ctFit:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/regCtsem/">regCtsem</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">38723</span><span class="op">)</span></span>
<span><span class="co">## Directly taken from ?ctFit:</span></span>
<span><span class="co">###Example from Voelkle, Oud, Davidov, and Schmidt (2012) - anomia and authoritarianism.  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">AnomAuth</span><span class="op">)</span> </span>
<span><span class="va">AnomAuthmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>LAMBDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>                         Tpoints <span class="op">=</span> <span class="fl">5</span>, n.latent <span class="op">=</span> <span class="fl">2</span>, n.manifest <span class="op">=</span> <span class="fl">2</span>, MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, TRAITVAR <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> </span>
<span><span class="va">AnomAuthfit</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span><span class="va">AnomAuth</span>, <span class="va">AnomAuthmodel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># regularization</span></span>
<span><span class="va">regularizedModel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                              dataset <span class="op">=</span> <span class="va">AnomAuth</span>, </span>
<span>                              regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>By default <strong>regCtsem</strong> will use 50 different values for
<span class="math inline">\(\lambda\)</span>. The maximally required
<span class="math inline">\(\lambda\)</span> is automatically computed
(<span class="math inline">\(\lambda_\max\)</span>) and values in
between <span class="math inline">\(0\)</span> and <span class="math inline">\(\lambda_\max\)</span> are generated with
getCurvedLambda() (see ?getCurvedLambda). More <span class="math inline">\(\lambda\)</span> values can be requested with the
lambdasAutoLength argument (e.g., lambdasAutoLength = 100).
Additionally, <strong>regCtsem</strong> will default to generating more
<span class="math inline">\(\lambda\)</span> values close to <span class="math inline">\(0\)</span> and less values close to <span class="math inline">\(\lambda_\max\)</span> (see ?getCurvedLambda). This
can be changed with the lambdasAutoCurve argument (see ?regCtsem for
more details). Finally, specific <span class="math inline">\(\lambda\)</span> values can be passed to the
function as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                              dataset <span class="op">=</span> <span class="va">AnomAuth</span>,</span>
<span>                              lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.1</span>,<span class="fl">.01</span><span class="op">)</span>,</span>
<span>                              regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This allows for further “zooming in” on specific regions.</p>
<p>Let’s plot the regularization trajectories:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regularizedModel1</span><span class="op">)</span></span></code></pre></div>
<p><img src="regCtsem_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regularizedModel2</span><span class="op">)</span></span></code></pre></div>
<p><img src="regCtsem_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>If 50 <span class="math inline">\(\lambda\)</span> values are used
(the default), this internally results in 50 different models with
increasing sparsity. An important question now is how the best model can
be found. By default <strong>regCstem</strong> will compute the AIC and
BIC for each of these models. They can be accessed with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel1</span><span class="op">$</span><span class="va">fit</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;                            0 0.00388266682395807 0.00795214091769518</span></span>
<span><span class="co">#&gt; regM2LL             23415.93            23418.83            23421.85</span></span>
<span><span class="co">#&gt; m2LL                23415.93            23415.94            23415.98</span></span>
<span><span class="co">#&gt; AIC                 23443.93            23443.94            23443.98</span></span>
<span><span class="co">#&gt; BIC                 23526.66            23526.67            23526.71</span></span>
<span><span class="co">#&gt; estimatedParameters    14.00               14.00               14.00</span></span>
<span><span class="co">#&gt;                     0.0122174101644433 0.016687894882666</span></span>
<span><span class="co">#&gt; regM2LL                       23424.98          23428.23</span></span>
<span><span class="co">#&gt; m2LL                          23416.05          23416.16</span></span>
<span><span class="co">#&gt; AIC                           23444.05          23444.16</span></span>
<span><span class="co">#&gt; BIC                           23526.78          23526.88</span></span>
<span><span class="co">#&gt; estimatedParameters              14.00             14.00</span></span></code></pre></div>
<p>The best model can be extracted with the summary function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regularizedModel1</span>, criterion <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "|---regCtsem results--------------------------------------------------|"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] "The best AIC value was observed for:"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] " --- Parameter estimates: --- "</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;          0.47324300         -0.00461089          0.15450974         -0.44728217 </span></span>
<span><span class="co">#&gt;     drift_eta1_eta2          drift_eta2     drift_eta2_eta1               mm_Y1 </span></span>
<span><span class="co">#&gt;          0.23249715         -0.11746667          0.04329256          2.68744439 </span></span>
<span><span class="co">#&gt;               mm_Y2            T0m_eta1            T0m_eta2     T0VAR_eta1_eta1 </span></span>
<span><span class="co">#&gt;          2.86338104         -0.18401247         -0.02065659          0.63286133 </span></span>
<span><span class="co">#&gt;     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;          0.24473121          0.45757744 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] " --- Fit: --- "</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt;             regM2LL                m2LL                 AIC                 BIC </span></span>
<span><span class="co">#&gt;            23415.93            23415.93            23443.93            23526.66 </span></span>
<span><span class="co">#&gt; estimatedParameters </span></span>
<span><span class="co">#&gt;               14.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] "|----------------------------------------------------------------------|"</span></span></code></pre></div>
<p>In this case the unregularized model outperforms the regularized
models.</p>
<p>Alternatively, cross-validation can be used. However, to this end the
model must be refit requesting cross-validation. Depending on the model
and the number of cross-validation sets requested, this can take some
time.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>,</span>
<span>                             lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.1</span>,<span class="fl">.01</span><span class="op">)</span>,</span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             autoCV <span class="op">=</span> <span class="st">"kFold"</span>, <span class="co"># k-Fold cross-validation</span></span>
<span>                             k <span class="op">=</span> <span class="fl">3</span> <span class="co"># k = 3 folds</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now the fit for the cross-validation is given in the regularizedModel
object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span><span class="op">$</span><span class="va">fit</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]</span></span>
<span><span class="co">#&gt; CV1  7764.468 7764.078 7763.778 7763.518 7763.314</span></span>
<span><span class="co">#&gt; CV2  7889.158 7889.651 7890.185 7890.765 7891.380</span></span>
<span><span class="co">#&gt; CV3  7789.438 7789.375 7789.357 7789.387 7789.478</span></span>
<span><span class="co">#&gt; mean 7814.355 7814.368 7814.440 7814.557 7814.724</span></span></code></pre></div>
<p>Finally, note that <strong>regCtsem</strong> internally translates
the models to C++ (using <strong>RcppArmadillo</strong>; Eddelbuettel
&amp; Sanderson, 2014) with the function regCtsem::cpptsemFromCtsem (see
?cpptsemFromCtsem). Currently some specific model settings from
<strong>ctsemOMX</strong> are not available in
<strong>regCtsem</strong>. <strong>regCtsem</strong> will throw an error
if it encounters such cases.</p>
<div class="section level3">
<h3 id="lasso-and-adaptive-lasso">LASSO and adaptive LASSO<a class="anchor" aria-label="anchor" href="#lasso-and-adaptive-lasso"></a>
</h3>
<p>A difficulty in LASSO regularized CTSEM is that the same <span class="math inline">\(\lambda\)</span> is used for all regularized
parameters. This is only justified if the regularized parameters have
the same units (i.e., they all have the same scale). In latent variable
models this is difficult to control. Here, <strong>regCtsem</strong>
offers an approximate standardization. To this end the T0-variance or
the asymptotic diffusion can be used:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>,</span>
<span>                             lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.1</span>,<span class="fl">.01</span><span class="op">)</span>,</span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             standardizeDrift <span class="op">=</span> <span class="st">"T0VAR"</span><span class="op">)</span></span>
<span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>,</span>
<span>                             lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.1</span>,<span class="fl">.01</span><span class="op">)</span>,</span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             standardizeDrift <span class="op">=</span> <span class="st">"asymptoticDiffusion"</span><span class="op">)</span></span></code></pre></div>
<p>Also the adaptive LASSO can be thought of as a form of
standardization. By default <span class="math inline">\(\lambda_j =
\frac{\lambda}{|\hat\theta_j|}\)</span>, where <span class="math inline">\(\hat\theta_j\)</span> is the maximum likelihood
estimate for <span class="math inline">\(\theta_j\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>,</span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             penalty <span class="op">=</span> <span class="st">"adaptiveLASSO"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regularizedModel</span><span class="op">)</span></span></code></pre></div>
<p><img src="regCtsem_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="full-information-maximum-likelihood-and-kalman-filter">Full Information Maximum Likelihood and Kalman Filter<a class="anchor" aria-label="anchor" href="#full-information-maximum-likelihood-and-kalman-filter"></a>
</h3>
<p>The -2 log Likelihood <span class="math inline">\(L(\pmb
\theta)\)</span> shown above can be computed with the Full Information
Maximum Likelihood (FIML) procedure and the Kalman filter. They result
in the same fit but might show very different run times. In general if
the sample size is large, the number of unique time intervals between
measurement occasions is small, and many individuals were observed at
the same time points FIML will be much faster. On the other hand if the
sample size is small, most time intervals are unique, and there is a
large number of time points the Kalman filter will be much faster. To
switch between both estimation procedures, we have to change the
objective in ctFit first:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">startFIML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">AnomAuthfitFIML</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span><span class="va">AnomAuth</span>, <span class="va">AnomAuthmodel</span>, </span>
<span>                         objective <span class="op">=</span> <span class="st">"mxRAM"</span><span class="op">)</span> <span class="co"># Use FIML</span></span>
<span><span class="va">endFIML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">startKalman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">AnomAuthfitKalman</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span><span class="va">AnomAuth</span>, <span class="va">AnomAuthmodel</span>, </span>
<span>                           objective <span class="op">=</span> <span class="st">"Kalman"</span><span class="op">)</span> <span class="co"># use Kalman filter</span></span>
<span><span class="va">endKalman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If we look at the run times for these examples, we will see that, for
our example, FIML is a lot faster:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">endFIML</span> <span class="op">-</span> <span class="va">startFIML</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 0.8063128 secs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">endKalman</span> <span class="op">-</span> <span class="va">startKalman</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 31.4024 secs</span></span></code></pre></div>
<p>If a model is fitted with the Kalman filter in
<strong>ctsemOMX</strong> and then passed to <strong>regCtsem</strong>,
<strong>regCtsem</strong> will also use the Kalman filter (don’t run the
following code, it will take a very long time):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfitKalman</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>,</span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             penalty <span class="op">=</span> <span class="st">"adaptiveLASSO"</span><span class="op">)</span></span></code></pre></div>
<p>Now, to give an example where the Kalman filter excels:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">175446</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## define the population model:</span></span>
<span></span>
<span><span class="co"># set the drift matrix. Note that drift eta_1_eta2 is set to equal 0 in the population.</span></span>
<span><span class="va">ct_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>,<span class="fl">.2</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">generatingModel</span><span class="op">&lt;-</span><span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">100</span>,n.latent<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                n.TDpred<span class="op">=</span><span class="fl">0</span>,n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                DRIFT<span class="op">=</span><span class="va">ct_drift</span>,</span>
<span>                                DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0VAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate a training data and testing data set</span></span>
<span><span class="va">traindata</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctGenerate.html" class="external-link">ctGenerate</a></span><span class="op">(</span><span class="va">generatingModel</span>,n.subjects <span class="op">=</span> <span class="fl">10</span>, wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build the analysis model. Note that drift eta1_eta2 is freely estimated</span></span>
<span><span class="co"># although it is 0 in the population.</span></span>
<span><span class="va">myModel</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">100</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,</span>
<span>                          n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                          LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'eta1_eta1'</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">'eta2_eta2'</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0VAR<span class="op">=</span><span class="st">"auto"</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span><span class="va">fit_myModel</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">traindata</span>, ctmodelobj <span class="op">=</span> <span class="va">myModel</span>, objective <span class="op">=</span> <span class="st">"Kalman"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select DRIFT values:</span></span>
<span><span class="va">regIndicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Optimization with GIST:</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="fu">::</span><span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                               dataset <span class="op">=</span> <span class="va">traindata</span>,</span>
<span>                               regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                               lambdasAutoLength <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span><span class="op">)</span></span></code></pre></div>
<p><img src="regCtsem_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="extracting-the-best-parameters-and-models">Extracting the Best Parameters and Models<a class="anchor" aria-label="anchor" href="#extracting-the-best-parameters-and-models"></a>
</h3>
<p>The best parameters can be extracted as follows:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getFinalParameters.html">getFinalParameters</a></span><span class="op">(</span>regCtsemObject <span class="op">=</span> <span class="va">regModel</span>, </span>
<span>                   criterion <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; $criterion</span></span>
<span><span class="co">#&gt; [1] "AIC"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 3.794832</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parameters</span></span>
<span><span class="co">#&gt;      T0var_eta1      T0var_eta2 T0var_eta2_eta1      drift_eta1 drift_eta1_eta2 </span></span>
<span><span class="co">#&gt;    -0.299051873    -0.265037440     0.146354259    -0.262008349     0.000000000 </span></span>
<span><span class="co">#&gt;      drift_eta2 drift_eta2_eta1       eta1_eta1       eta2_eta2           mm_Y1 </span></span>
<span><span class="co">#&gt;    -0.474233915     0.168628834    -0.699650904    -0.685913204     0.059504253 </span></span>
<span><span class="co">#&gt;           mm_Y2 </span></span>
<span><span class="co">#&gt;     0.009090133</span></span></code></pre></div>
<p>By default, these parameters will returned in raw form; that is, in
the form in which they are implemented internally (e.g., covariances are
implemented with the log-Cholesky parameterization; Pinheiro &amp;
Bates, 1996). To get the transformed parameters set raw = FALSE:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getFinalParameters.html">getFinalParameters</a></span><span class="op">(</span>regCtsemObject <span class="op">=</span> <span class="va">regModel</span>, </span>
<span>                   criterion <span class="op">=</span> <span class="st">"AIC"</span>, </span>
<span>                   raw <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> </span>
<span><span class="co">#&gt; $criterion</span></span>
<span><span class="co">#&gt; [1] "AIC"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 3.794832</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parameters</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.245480430         0.000000000         0.255101858        -0.262008349 </span></span>
<span><span class="co">#&gt;     drift_eta1_eta2          drift_eta2     drift_eta2_eta1               mm_Y1 </span></span>
<span><span class="co">#&gt;         0.000000000        -0.474233915         0.168628834         0.059504253 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.009090133         0.553031306         0.109209463         0.613400525</span></span></code></pre></div>
<p>The best model can be extracted as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">finalModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getFinalModel.html">getFinalModel</a></span><span class="op">(</span>regCtsemObject <span class="op">=</span> <span class="va">regModel</span>, </span>
<span>                            criterion <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best fit for AIC was observed for lambda = 3.79483223498423.</span></span></code></pre></div>
<p>While this model is implemented in C++, many of its components are
accessible with the $ operator:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">finalModel</span><span class="op">$</span><span class="va">DRIFTValues</span></span>
<span><span class="co">#&gt;            [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] -0.2620083  0.0000000</span></span>
<span><span class="co">#&gt; [2,]  0.1686288 -0.4742339</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="saving-and-restoring-models">Saving and Restoring Models<a class="anchor" aria-label="anchor" href="#saving-and-restoring-models"></a>
</h3>
<p>As usual objects created with <strong>regCtsem</strong> can be saved
as follows:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">regModel</span>, file <span class="op">=</span> <span class="st">"regModel.RData"</span><span class="op">)</span></span></code></pre></div>
<p>However, when loading the model in the next session the underlying
C++ object will be lost. This model can restored:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"regModel.RData"</span><span class="op">)</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/restore.html">restore</a></span><span class="op">(</span><span class="va">regModel</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="practical-considerations">Practical Considerations<a class="anchor" aria-label="anchor" href="#practical-considerations"></a>
</h3>
<p>Fitting regularized CTSEM to empirical data can be challenging and
requires several decisions for which we want to give some
guidelines.</p>
<div class="section level4">
<h4 id="selecting-regularized-parameters">Selecting Regularized Parameters<a class="anchor" aria-label="anchor" href="#selecting-regularized-parameters"></a>
</h4>
<p>In general any of the paraemters can be regularized with
<strong>regCtsem</strong>. If you are unsure which parameters these
might be, or what they are called in your model, use the following
function:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/showParameters.html">showParameters</a></span><span class="op">(</span><span class="va">fit_myModel</span><span class="op">)</span></span>
<span><span class="co">#&gt;              label model        matrix row col        value lbound ubound</span></span>
<span><span class="co">#&gt; 1       drift_eta1 ctsem         DRIFT   1   1 -0.255694277     NA     NA</span></span>
<span><span class="co">#&gt; 2  drift_eta1_eta2 ctsem         DRIFT   1   2 -0.021711245     NA     NA</span></span>
<span><span class="co">#&gt; 3       drift_eta2 ctsem         DRIFT   2   2 -0.482393863     NA     NA</span></span>
<span><span class="co">#&gt; 4  drift_eta2_eta1 ctsem         DRIFT   2   1  0.185281955     NA     NA</span></span>
<span><span class="co">#&gt; 5        eta1_eta1 ctsem DIFFUSIONbase   1   1 -0.702270347     NA     NA</span></span>
<span><span class="co">#&gt; 6        eta2_eta2 ctsem DIFFUSIONbase   2   2 -0.683048161     NA     NA</span></span>
<span><span class="co">#&gt; 7            mm_Y1 ctsem MANIFESTMEANS   1   1  0.059154164     NA     NA</span></span>
<span><span class="co">#&gt; 8            mm_Y1 ctsem             D   1   1  0.059154164     NA     NA</span></span>
<span><span class="co">#&gt; 9            mm_Y2 ctsem MANIFESTMEANS   2   1  0.008901854     NA     NA</span></span>
<span><span class="co">#&gt; 10           mm_Y2 ctsem             D   2   1  0.008901854     NA     NA</span></span>
<span><span class="co">#&gt; 11      T0var_eta1 ctsem     T0VARbase   1   1 -0.296170291     NA     NA</span></span>
<span><span class="co">#&gt; 12      T0var_eta2 ctsem     T0VARbase   2   2 -0.262264074     NA     NA</span></span>
<span><span class="co">#&gt; 13 T0var_eta2_eta1 ctsem     T0VARbase   2   1  0.146853902     NA     NA</span></span></code></pre></div>
<p>This function will show you the labels and values of the parameters
in the model.</p>
<p>Note that it is a lot easier to regularize the drift values, the
loadings, the manifest or the latent means. All covariance parameters
(T0VAR, values in <span class="math inline">\(\pmb G\)</span>, and
manifest variances) are implemented with the log-Cholesky
parameterization (Pinheiro &amp; Bates, 1996) and you might get
surprising results when regularizing them. Be sure to familiarize
yourself with this implementation first before attempting to regularize
any (co)variance parameters.</p>
</div>
<div class="section level4">
<h4 id="regularizing-towards-specific-values">Regularizing Towards Specific Values<a class="anchor" aria-label="anchor" href="#regularizing-towards-specific-values"></a>
</h4>
<p>As mentioned above, parameters can also be regularized towards values
other than <span class="math inline">\(0\)</span>. This is currently
only supported with GIST as optimizer. For example:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regIndicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span><span class="va">targetVector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span> <span class="op">=</span> <span class="fl">.5</span>, <span class="st">"drift_eta1_eta2"</span> <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="fu">::</span><span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                               dataset <span class="op">=</span> <span class="va">traindata</span>,</span>
<span>                               regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                               lambdasAutoLength <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                               targetVector <span class="op">=</span> <span class="va">targetVector</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Both regularized parameters are now regularized towards .5:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span><span class="op">)</span></span></code></pre></div>
<p><img src="regCtsem_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>“#parameters on target” refers to the number of parameters which are
on their target values (here .5).</p>
<p>Regularizing parameters towards specific targets can be used to model
selected parameters person-specific while regularizing them towards the
group value (see Jacobucci &amp; Grimm, 2018 for a similar approach).
This feature is still experimental, but can be used as follows:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regIndicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span><span class="va">subjectSpecificParameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                     dataset <span class="op">=</span> <span class="va">traindata</span>,</span>
<span>                     regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                     lambdasAutoLength <span class="op">=</span> <span class="fl">5</span>, <span class="co"># 5 will not be enough, but this takes some time to execute</span></span>
<span>                     subjectSpecificParameters <span class="op">=</span> <span class="va">subjectSpecificParameters</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regModel</span>, criterion <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "|---regCtsem results--------------------------------------------------|"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] "The best AIC value was observed for:"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 5.079097</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] " --- Parameter estimates: --- "</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates</span></span>
<span><span class="co">#&gt; $ParameterEstimates$group1</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G1          drift_eta2  drift_eta2_eta1_G1               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group2</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G2          drift_eta2  drift_eta2_eta1_G2               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group3</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G3          drift_eta2  drift_eta2_eta1_G3               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group4</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G4          drift_eta2  drift_eta2_eta1_G4               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group5</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G5          drift_eta2  drift_eta2_eta1_G5               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group6</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G6          drift_eta2  drift_eta2_eta1_G6               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group7</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G7          drift_eta2  drift_eta2_eta1_G7               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group8</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G8          drift_eta2  drift_eta2_eta1_G8               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group9</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G9          drift_eta2  drift_eta2_eta1_G9               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ParameterEstimates$group10</span></span>
<span><span class="co">#&gt; DIFFUSION_eta1_eta1 DIFFUSION_eta2_eta1 DIFFUSION_eta2_eta2          drift_eta1 </span></span>
<span><span class="co">#&gt;         0.244811720         0.000000000         0.253581971        -0.255692783 </span></span>
<span><span class="co">#&gt; drift_eta1_eta2_G10          drift_eta2 drift_eta2_eta1_G10               mm_Y1 </span></span>
<span><span class="co">#&gt;        -0.021711245        -0.482393484         0.185281955         0.059152976 </span></span>
<span><span class="co">#&gt;               mm_Y2     T0VAR_eta1_eta1     T0VAR_eta2_eta1     T0VAR_eta2_eta2 </span></span>
<span><span class="co">#&gt;         0.008902174         0.570321136         0.113663059         0.613192886 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] " Parameters were regularized towards the following values:"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Targets</span></span>
<span><span class="co">#&gt;  drift_eta2_eta1_G1  drift_eta2_eta1_G2  drift_eta2_eta1_G3  drift_eta2_eta1_G4 </span></span>
<span><span class="co">#&gt;          0.18528196          0.18528196          0.18528196          0.18528196 </span></span>
<span><span class="co">#&gt;  drift_eta2_eta1_G5  drift_eta2_eta1_G6  drift_eta2_eta1_G7  drift_eta2_eta1_G8 </span></span>
<span><span class="co">#&gt;          0.18528196          0.18528196          0.18528196          0.18528196 </span></span>
<span><span class="co">#&gt;  drift_eta2_eta1_G9 drift_eta2_eta1_G10  drift_eta1_eta2_G1  drift_eta1_eta2_G2 </span></span>
<span><span class="co">#&gt;          0.18528196          0.18528196         -0.02171125         -0.02171125 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G3  drift_eta1_eta2_G4  drift_eta1_eta2_G5  drift_eta1_eta2_G6 </span></span>
<span><span class="co">#&gt;         -0.02171125         -0.02171125         -0.02171125         -0.02171125 </span></span>
<span><span class="co">#&gt;  drift_eta1_eta2_G7  drift_eta1_eta2_G8  drift_eta1_eta2_G9 drift_eta1_eta2_G10 </span></span>
<span><span class="co">#&gt;         -0.02171125         -0.02171125         -0.02171125         -0.02171125 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] " --- Fit: --- "</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt;             regM2LL                m2LL                 AIC                 BIC </span></span>
<span><span class="co">#&gt;            2241.850            2241.850            2259.850            2262.573 </span></span>
<span><span class="co">#&gt; estimatedParameters </span></span>
<span><span class="co">#&gt;               9.000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; [1] "|----------------------------------------------------------------------|"</span></span></code></pre></div>
<p>The group-indicator in the summary refers to the individuals in the
data set. Note that such models will take a relatively long time to
run.</p>
</div>
<div class="section level4">
<h4 id="avoiding-local-minima">Avoiding Local Minima<a class="anchor" aria-label="anchor" href="#avoiding-local-minima"></a>
</h4>
<p>When working with real data local minima appear to be relatively
common. <strong>regCtsem</strong> therefore makes extensive use of
multiple starting values and additionally relies on approximating the
solution with established optimizers. These safety features come at a
considerable increase in runtime and adjusting the settings can - in
turn - speed up the computation at the price of an increased risk of
running into local minima. We recommend using the implemented safety
features when working with empirical data; with simulated data we
observed that local minima are less common and turning off the safety
features might not affect the results. Turning off all safety features
can be done as follows:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>, </span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>, </span>
<span>                             trainingWheels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># switch off all safety features</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="setting-lambda">Setting <span class="math inline">\(\lambda\)</span><a class="anchor" aria-label="anchor" href="#setting-lambda"></a>
</h4>
<p>Selecting reasonable values for <span class="math inline">\(\lambda\)</span> can be challenging. In general
initially running <strong>regCtsem</strong> with a limited number of
<span class="math inline">\(\lambda\)</span> values between <span class="math inline">\(0\)</span> and the automatically chosen <span class="math inline">\(\lambda_{\max}\)</span> can provide a good
overview. Afterwards rerunning the model with more informed <span class="math inline">\(\lambda\)</span> values might be advisable. The
number of <span class="math inline">\(\lambda\)</span> values also
directly affects runtimes and results.</p>
</div>
<div class="section level4">
<h4 id="optimziation">Optimziation<a class="anchor" aria-label="anchor" href="#optimziation"></a>
</h4>
<p><strong>regCtsem</strong> currently supports three different
optimization approaches:</p>
<p>The default is to use an exact optimization. Or, to be more specific,
to first use an approximate optimization and then fine tune the results
with the exact optimizer. Two different exact optimizers are currently
supported: <em>GIST</em> (Gong et al., 2013) and <em>GLMNET</em>
(Friedman et al., 2010, Yuan et al., 2012). In most cases both
optimizers should return similar results and we default to GIST.
However, depending on the specific data set at hand and the settings of
the optimizer, one might see one outperforming the other. Switching
between the optimizers can be done as follows:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>, </span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             optimizer <span class="op">=</span> <span class="st">"GIST"</span><span class="op">)</span></span>
<span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>, </span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             optimizer <span class="op">=</span> <span class="st">"GLMNET"</span><span class="op">)</span></span></code></pre></div>
<p>Both optimizers can be fine tuned. See ?controlGIST and
?controlGLMNET for more details. For instance, one might want to adjust
the maximal number of outer iterations for GIST:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>, </span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             optimizer <span class="op">=</span> <span class="st">"GIST"</span>,</span>
<span>                             control <span class="op">=</span> <span class="fu"><a href="../reference/controlGIST.html">controlGIST</a></span><span class="op">(</span>maxIter_out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>An <em>approximate optimization</em> is provided based on
<strong>Rsolnp</strong> (Ghalanos &amp; Theussl, 2015; Ye, 1987) or
<strong>optimx</strong> (Nash &amp; Varadhan, 2011). The most basic
specification is given by:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>, </span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             optimization <span class="op">=</span> <span class="st">"approx"</span><span class="op">)</span></span></code></pre></div>
<p>The control argument allows for further fine tuning the optimizer.
See ?controlApprox for more details.</p>
</div>
<div class="section level4">
<h4 id="parallelization">Parallelization<a class="anchor" aria-label="anchor" href="#parallelization"></a>
</h4>
<p>Given that <strong>regCtsem</strong> can result in long runtimes one
might want to parallelize the computation. This is currently not
supported by the package itself. However, if cross-validation is used
one can start multiple instances of the scripts and pass the training
and validation set manually to <strong>regCtsem</strong> as follows:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regularizedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regCtsem.html">regCtsem</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">AnomAuthfit</span>, </span>
<span>                             dataset <span class="op">=</span> <span class="va">AnomAuth</span>, </span>
<span>                             regIndicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span>,</span>
<span>                             cvSample <span class="op">=</span> <span class="va">validationSet</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Important</strong>: If your system can use OpenMp,
<strong>RcppArmadillo</strong> might try using all your cores. This can
slow down the optimization and we currently recommend setting the number
of threads used to 1. To this end, execute the following command once
<strong>before loading regCtsem</strong>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>OMP_NUM_THREADS <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="starting-with-a-sparse-model">Starting with a Sparse Model<a class="anchor" aria-label="anchor" href="#starting-with-a-sparse-model"></a>
</h4>
<p>Sometimes a model where all parameters are freely estimated is too
flexible and very difficult to optimize. In these cases it can be useful
to start with a sparse model; that is, a model where all regularized
parameters are already set to zero. The penalty is then reduced
gradually to allow for parameters to diverge from zero. This can be done
as follows:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">17046</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Population model:</span></span>
<span></span>
<span><span class="co"># set the drift matrix. Note that drift eta_1_eta2 is set to equal 0 in the population.</span></span>
<span><span class="va">ct_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>,<span class="fl">.2</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">generatingModel</span><span class="op">&lt;-</span><span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">10</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,</span>
<span>                                n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                DRIFT<span class="op">=</span><span class="va">ct_drift</span>,</span>
<span>                                DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                T0VAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate a training data set</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctGenerate.html" class="external-link">ctGenerate</a></span><span class="op">(</span><span class="va">generatingModel</span>, n.subjects <span class="op">=</span> <span class="fl">100</span>, wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build the analysis model. Note that drift eta1_eta2 is freely estimated</span></span>
<span><span class="co"># although it is 0 in the population.</span></span>
<span><span class="va">myModel</span> <span class="op">&lt;-</span> <span class="fu">ctsem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>Tpoints<span class="op">=</span><span class="fl">10</span>,n.latent<span class="op">=</span><span class="fl">2</span>,n.TDpred<span class="op">=</span><span class="fl">0</span>,</span>
<span>                          n.TIpred<span class="op">=</span><span class="fl">0</span>,n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                          LAMBDA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          CINT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          DIFFUSION<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'eta1_eta1'</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">'eta2_eta2'</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0MEANS<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                          T0VAR<span class="op">=</span><span class="st">"auto"</span>, type <span class="op">=</span> <span class="st">"omx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit the model using ctsemOMX, but without optimization:</span></span>
<span><span class="va">fit_myModel</span> <span class="op">&lt;-</span> <span class="fu">ctsemOMX</span><span class="fu">::</span><span class="fu">ctFit</span><span class="op">(</span><span class="va">dat</span>, </span>
<span>                               <span class="va">myModel</span>, </span>
<span>                               useOptimizer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select DRIFT values for regularization:</span></span>
<span><span class="va">regIndicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift_eta2_eta1"</span>, <span class="st">"drift_eta1_eta2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optimize model using GIST with lasso penalty</span></span>
<span><span class="va">regModel</span> <span class="op">&lt;-</span> <span class="fu">regCtsem</span><span class="fu">::</span><span class="fu"><a href="../reference/startFromSparse.html">startFromSparse</a></span><span class="op">(</span>ctsemObject <span class="op">=</span> <span class="va">fit_myModel</span>,</span>
<span>                                      dataset <span class="op">=</span> <span class="va">dat</span>,</span>
<span>                                      regIndicators <span class="op">=</span> <span class="va">regIndicators</span>,</span>
<span>                                      standardizeDrift <span class="op">=</span> <span class="st">"asymptoticDiffusion"</span>,</span>
<span>                                      lambdasAutoLength <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">regModel</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regModel</span><span class="op">)</span></span></code></pre></div>
<p><img src="regCtsem_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>Note that when combining startFromSparse with automatic
standardization the T0VAR or the asymptoticDiffusion are taken from the
sparse model. This is reasonable if the true model is assumed to be
relatively similar to the sparse model, but might result in a poor
standardization otherwise.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<ul>
<li>Driver, C. C., Oud, J. H. L., &amp; Voelkle, M. C. (2017).
Continuous Time Structural Equation Modelling With R Package ctsem.
Journal of Statistical Software, 77(5), 1–36. <a href="https://doi.org/10.18637/jss.v077.i05" class="external-link uri">https://doi.org/10.18637/jss.v077.i05</a>
</li>
<li>Eddelbuettel, D., &amp; Sanderson, C. (2014). RcppArmadillo:
Accelerating R with high-performance C++ linear algebra. Computational
Statistics &amp; Data Analysis, 71, 1054–1063. <a href="https://doi.org/10.1016/j.csda.2013.02.005" class="external-link uri">https://doi.org/10.1016/j.csda.2013.02.005</a>
</li>
<li>Friedman, J., Hastie, T., &amp; Tibshirani, R. (2010).
Regularization Paths for Generalized Linear Models via Coordinate
Descent. Journal of Statistical Software, 33(1), 1–20. <a href="https://doi.org/10.18637/jss.v033.i01" class="external-link uri">https://doi.org/10.18637/jss.v033.i01</a>
</li>
<li>Ghalanos, A., &amp; Theussl, S. (2015). Rsolnp: General Non-linear
Optimization Using Augmented Lagrange Multiplier Method (R package
version 1.16) [Computer software].</li>
<li>Gong, P., Zhang, C., Lu, Z., Huang, J., &amp; Ye, J. (2013). A
General Iterative Shrinkage and Thresholding Algorithm for Non-convex
Regularized Optimization Problems. Proceedings of the 30th International
Conference on Machine Learning, 28(2)(2), 37–45.</li>
<li>Huang, P.-H., Chen, H., &amp; Weng, L.-J. (2017). A penalized
likelihood method for structural equation modeling. Psychometrika,
82(2), 329–354. <a href="https://doi.org/10.1007/s11336-017-9566-9" class="external-link uri">https://doi.org/10.1007/s11336-017-9566-9</a>
</li>
<li>Jacobucci, R., &amp; Grimm, K. J. (2018). Regularized Estimation of
Multivariate Latent Change Score Models. In E. Ferrer, S. M. Boker,
&amp; K. J. Grimm (Eds.), Longitudinal Multivariate Psychology (1st ed.,
pp. 109–125). Routledge. <a href="https://doi.org/10.4324/9781315160542-6" class="external-link uri">https://doi.org/10.4324/9781315160542-6</a>
</li>
<li>Jacobucci, R., Grimm, K. J., &amp; McArdle, J. J. (2016).
Regularized structural equation modeling. Structural Equation Modeling:
A Multidisciplinary Journal, 23(4), 555–566. <a href="https://doi.org/10.1080/10705511.2016.1154793" class="external-link uri">https://doi.org/10.1080/10705511.2016.1154793</a>
</li>
<li>Nash, J. C., &amp; Varadhan, R. (2011). Unifying Optimization
Algorithms to Aid Software System Users: Optimx for R. Journal of
Statistical Software, 43(9), 1–14. <a href="https://doi.org/10.18637/jss.v043.i09" class="external-link uri">https://doi.org/10.18637/jss.v043.i09</a>
</li>
<li>Pinheiro, J. C., &amp; Bates, D. M. (1996). Unconstrained
parametrizations for variance-covariance matrices. Statistics and
Computing, 6(3), 289–296. <a href="https://doi.org/10.1007/BF00140873" class="external-link uri">https://doi.org/10.1007/BF00140873</a>
</li>
<li>Tibshirani, R. (1996). Regression Shrinkage and Selection via the
Lasso. Journal of the Royal Statistical Society. Series B
(Methodological), 58(1), 267–288.</li>
<li>Voelkle, M. C., Oud, J. H. L., Davidov, E., &amp; Schmidt, P.
(2012). An SEM Approach to Continuous Time Modeling of Panel Data:
Relating Authoritarianism and Anomia. Psychological Methods, 17(2),
176–192. <a href="https://doi.org/10.1037/a0027543" class="external-link uri">https://doi.org/10.1037/a0027543</a>
</li>
<li>Ye, Y. (1987). Interior Algorithms for Linear, Quadratic, and
Linearly Constrained Non-Linear Programming [Ph.D. Thesis, Department of
EES, Stanford University.]. <a href="https://web.stanford.edu/~yyye/YinyuYePhD.pdf" class="external-link uri">https://web.stanford.edu/~yyye/YinyuYePhD.pdf</a>
</li>
<li>Yuan, G.-X., Ho, C.-H., &amp; Lin, C.-J. (2012). An improved GLMNET
for l1-regularized logistic regression. The Journal of Machine Learning
Research, 13, 1999–2030. <a href="https://doi.org/10.1145/2020408.2020421" class="external-link uri">https://doi.org/10.1145/2020408.2020421</a>
</li>
<li>Zou, H. (2006). The Adaptive Lasso and Its Oracle Properties.
Journal of the American Statistical Association, 101(476), 1418–1429. <a href="https://doi.org/10.1198/016214506000000735" class="external-link uri">https://doi.org/10.1198/016214506000000735</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
